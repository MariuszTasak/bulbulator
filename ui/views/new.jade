extends layout

block content
  .container
    div(ng-controller='NewEnvironmentCtrl')
      .page-header
        h1 Deploy a new environment

      .row
        .col-md-5

          form.form-horizontal(role='form')
              .form-group
                  label.col-sm-3.control-label(for='repository') Repository
                  .col-sm-6
                    select#repository.form-control(name='repository', ng-model='repository', ng-options="s.owner.login for s in repositories", ng-change="load.branches(repository);", ng-disabled='!repositories')
                      option(value='') -- choose repository --
              .form-group
                  label.col-sm-3.control-label(for='branch') Branch
                  .col-sm-6
                    select#branch.form-control(name='branch', ng-model='branch', ng-options="s.name for s in branches", ng-disabled='!branches', ng-change='commit=branch.commit.sha')
                      option(value='') -- choose branch --
              .form-group
                  label.col-sm-3.control-label(for='commit') Commit
                  .col-sm-9
                    input#commit.form-control(type='text', name='commit', ng-model='commit', ng-disabled='!branch', ng-value='branch.commit.sha')
              .form-group
                  label.col-sm-3.control-label(for='website') Website
                  .col-sm-6
                    select#website.form-control(name='website', ng-model='website', ng-options="s.name for s in websites", ng-change="load.environments(repository, commit, website);", ng-disabled='!websites')
                      option(value='') -- choose website --
              .form-group
                  label.col-sm-3.control-label(for='environment') Environment
                  .col-sm-6
                    select#environment.form-control(name='environment', disabled, ng-model='environment', ng-options="s.name for s in environments")
                      option(value='') -- choose environment --

              .form-group
                .col-sm-offset-3.col-sm-10
                  .checkbox
                    label
                      input(type='checkbox', name='send-email')
                      | Send me an email once the environment will be up
              .form-group
                .col-sm-offset-3.col-sm-10
                  button.btn.btn-success(type='submit') Deploy
        .col-md-7
          .desc
            .commit-selected(ng-show='commitInfo')
              | commit selected
            .form-filled(ng-show='formFilled')
              | form filled

  script.
    window.environments = !{JSON.stringify(environments)};